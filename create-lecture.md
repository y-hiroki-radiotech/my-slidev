---
description: 授業計画から講義全体のスライドを一括自動生成する
---

# 講義全体の自動生成 (完全自動実行モード)

**重要:** このワークフローは、ユーザーの介入なしに、開始から完了まで完全に自動で実行されるように設計されています。各ステップは完了後、ただちに次のステップへ移行してください。思考の途中でユーザーに確認を求めたり、作業を中断したりしないでください。

**引数:** 講義回数または講義テーマ (例: `/create-lecture 第1回` または `/create-lecture 放射線治療学入門`)

---

## ステップ1: 準備とコンテキスト設定

1. 現在のタスクコンテキストを確立する:
  - 講義名: `[引数で与えられた講義名]`
  - 日付: `[現在の日付をYYYYMMDD形式で取得]`
  - プランニングディレクトリパス: `.lecture-planning/[日付]-[講義名]/`
2. 上記プランニングディレクトリを作成する。
3. 以下のファイルを作成する:
  - `[プランニングディレクトリパス]/lecture-structure.md` (講義構造)
  - `[プランニングディレクトリパス]/content-outline.md` (内容アウトライン)
  - `[プランニングディレクトリパス]/tasklist.md` (タスクリスト)
  - `[プランニングディレクトリパス]/section-breakdown.md` (セクション分解)

## ステップ2: 授業計画の詳細分析

1. `CLAUDE.md`を読み、プロジェクト全体のルールとガイドラインを把握する。

2. `lesson_plan/`ディレクトリの全ファイルを読み込み、詳細に分析する:
  - `lesson_plan/第1回授業の全体像.md` - 授業全体の構成と時間配分
  - `lesson_plan/本論部分の詳細.md` - 各セクションの詳細内容
  - その他関連ファイル

3. 授業計画から以下の情報を抽出する:
  - 授業の目的と到達目標
  - 全体の時間配分
  - 各セクションのタイトルと内容
  - 重要な概念やキーワード
  - 図表・画像が必要な箇所
  - 学生に考えさせたいポイント

4. `slidev_write.md`でSlidevの全機能を確認する。

5. `format/template_sides.md`で標準フォーマットを確認する。

6. 自己紹介が必要かどうかを判断し、必要な場合は`pages/who_am_i.md`を確認する。

## ステップ3: 既存リソースとパターンの調査

1. `slides.md`が既に存在する場合は読み込み、現在の状態を把握する。

2. `pages/`ディレクトリ内の既存ページを確認:
  - `pages/who_am_i.md` (自己紹介)
  - `pages/flowchart.md` (フローチャート例)
  - その他のページ

3. `components/`ディレクトリ内の利用可能なVueコンポーネントを確認:
  - `components/Counter.vue`
  - その他のカスタムコンポーネント

4. `public/`ディレクトリ内の既存画像リソースを確認する。

5. Grepツールで既存のレイアウトパターンを検索:
  ```bash
  Grep('layout:', 'slides.md')
  Grep('grid grid-cols', 'slides.md')
  Grep('<div class=', 'slides.md')
  ```

## ステップ4: 計画フェーズ (プランニングファイルの自動生成)

1. `lecture-structure.md`に講義の全体構造を記述する:
  ```markdown
  # 講義全体構造

  ## 講義情報
  - 講義名: [講義名]
  - 対象: [対象学生]
  - 時間: [総時間]
  - 到達目標: [目標リスト]

  ## セクション構成
  1. 導入 (時間: XX分)
     - 自己紹介 (必要な場合)
     - 講義の目的と流れ

  2. 本論
     - セクション1: [タイトル] (時間: XX分)
     - セクション2: [タイトル] (時間: XX分)
     - ...

  3. まとめ (時間: XX分)
     - 重要ポイントの復習
     - 次回予告
     - 質疑応答
  ```

2. `content-outline.md`に各セクションの詳細内容を記述する:
  ```markdown
  # 内容詳細アウトライン

  ## セクション1: [タイトル]

  ### スライド1-1: [タイトル]
  - 内容: [要点]
  - レイアウト: [使用するレイアウト]
  - 画像/図表: [必要な素材]
  - アイコン: [使用するアイコン]

  ### スライド1-2: [タイトル]
  ...
  ```

3. `section-breakdown.md`にセクションごとのスライド枚数と見積もりを記述する:
  ```markdown
  # セクション別スライド分解

  ## 導入セクション (推定: X枚)
  - 自己紹介: 1枚
  - 講義の目的: 1枚
  - 本日の流れ: 1枚

  ## 本論セクション1: [タイトル] (推定: X枚)
  - 概要: 1枚
  - 詳細1: 2枚
  - 詳細2: 2枚
  - まとめ: 1枚

  ...

  ## 合計推定スライド枚数: XX枚
  ```

4. `tasklist.md`に実装タスクリストを作成する:
  ```markdown
  # 講義スライド作成タスクリスト

  ## 準備
  - [ ] slides.mdのバックアップを取る（git commit）
  - [ ] 必要な画像リソースをリストアップ
  - [ ] カスタムコンポーネントの必要性を判断

  ## フロントマター設定
  - [ ] テーマ設定
  - [ ] レイアウト設定
  - [ ] フォント設定
  - [ ] カラースキーム設定

  ## 導入セクション
  - [ ] 自己紹介スライド（必要な場合、who_am_i.mdをインポート）
  - [ ] 講義の目的スライド
  - [ ] 本日の流れスライド

  ## 本論セクション1: [タイトル]
  - [ ] セクションタイトルスライド
  - [ ] 概要スライド
  - [ ] 詳細スライド（複数）
  - [ ] 図表の挿入
  - [ ] アイコンの追加
  - [ ] セクションまとめスライド

  ## 本論セクション2: [タイトル]
  ...

  ## まとめセクション
  - [ ] 重要ポイント復習スライド
  - [ ] Take-homeメッセージスライド
  - [ ] 次回予告スライド
  - [ ] 質疑応答スライド
  - [ ] リソース案内スライド（参考文献、QRコードなど）

  ## 最終調整
  - [ ] 全スライドのフォーマット統一
  - [ ] 文字サイズチェック（28pt以上）
  - [ ] タイトルと内容の間のスペースチェック
  - [ ] アイコンの適切性チェック
  - [ ] 画像の配置確認
  - [ ] スライド番号の確認
  - [ ] トランジション効果の確認

  ## 検証
  - [ ] プレビュー確認（npm run dev）
  - [ ] レイアウト崩れチェック
  - [ ] 誤字脱字チェック
  - [ ] 授業計画との整合性確認
  ```

**このステップが正常に完了したら、決して停止せず、ただちにステップ5に進むこと。**

## ステップ5: バックアップの作成

1. 現在の`slides.md`が存在する場合、git commitを実行してバックアップを取る:
  ```bash
  git add slides.md
  git commit -m "Backup before creating new lecture: [講義名]"
  ```

2. 既存のスライドがある場合、`previous_slides/`ディレクトリに移動するか、適切にバックアップする。

**このステップが正常に完了したら、決して停止せず、ただちにステップ6に進むこと。**

## ステップ6: 実装ループ (tasklist.mdの完全消化)

**このステップは、`tasklist.md`の全タスクが `[x]` になるまで自動で繰り返されるループ処理です。**
**このステップが正常に完了したら、決して停止せず、ただちにステップ7に進むこと。**

**ループ開始:**

1. タスクリストの読み込み:
  - `[プランニングディレクトリパス]/tasklist.md`ファイルを読み込む。

2. 進捗の確認:
  - ファイル内に未完了タスク (`[ ]`) が存在するか確認する。
  - **もし未完了タスクが存在しない場合:** この実装ループは完了とみなし、ただちに**ステップ7**へ進む。
  - **もし未完了タスクが存在する場合:** 次の処理（3. タスクの実行）に進む。

3. タスクの実行:
  - `tasklist.md`の**先頭にある未完了タスク**を1つ特定する。
  - そのタスクを完了させるために必要な実装作業を実行する。
  - 以下のルールを厳守する:
    - **フロントマター**: 講義全体の設定を適切に記述
    - **スライド区切り**: `---`で各スライドを区切る
    - **フォーマット**: タイトルと内容の間に`***`と`<div class="mt-5"></div>`
    - **文字サイズ**: 本文は28pt以上
    - **画像**: `public/`に保存し、適切なクラスで配置
    - **アイコン**: `@iconify-json/mdi`から適切なものを選択
    - **レイアウト**: 既存パターンを踏襲（2カラム、画像配置など）
    - **自己紹介**: 必要な場合は`pages/who_am_i.md`をインポート
    - **テンプレート**: `format/template_sides.md`に従う

4. タスクリストの更新:
  - 実行したタスクが完了したら、`Edit`ツールを使用して`tasklist.md`を更新し、該当タスクを `[ ]` から `[x]` に変更する。

5. ループ継続:
  - **ステップ6の先頭 (1. タスクリストの読み込み) に戻り、処理を繰り返す。**

---
### ※ 実装ループ内の例外処理ルール ※

実装ループの実行中に以下の状況が発生した場合は、このルールに従って自律的に対処し、ループを継続すること。

- **ルールA: タスクが大きすぎる場合**
  - **対処法:** 現在のタスクをより小さな複数のサブタスクに分割する。`Edit`ツールを使い、元のタスクを削除し、その場所に新しいサブタスク（`[ ]`付き）を挿入する。その後、ループを継続する。

- **ルールB: 技術的理由でタスクが不要になった場合**
  - **条件:** 講義構成の変更、授業計画との整合性、技術的制約など、明確な理由がある場合にのみ適用。
  - **対処法:** `Edit`ツールを使い、該当タスクを `[x] ~~タスク名~~ (理由: [具体的な理由を簡潔に記述])` の形式で更新する。その後、ループを継続する。

- **ルールC: 画像リソースが未作成の場合**
  - **対処法:** プレースホルダーコメントを挿入し、必要な画像の説明を記載する。タスクは完了としてマークし、`section-breakdown.md`に「要作成画像リスト」を追記する。

- **❌ 絶対禁止の行為:**
  - 未完了タスクを「後でやる」「別タスクにする」などの理由で意図的にスキップすること。
  - 理由なく未完了タスクを放置してループを終了させること。
  - ユーザーに判断を仰ぐこと。

---

## ステップ7: プレビュー確認と最終調整

1. 開発サーバーが起動していない場合、Bashツールで`npm run dev`を実行する（バックグラウンド実行）。

2. `slides.md`を読み込み、以下を最終確認:
  - フロントマターの設定が適切か
  - 全スライドが適切に区切られているか
  - レイアウトが統一されているか
  - 文字サイズが適切か（28pt以上）
  - 画像が正しく配置されているか
  - アイコンが適切に使用されているか
  - スライド番号が正しいか

3. 問題があれば修正し、再度確認する。

**このステップが正常に完了したら、決して停止せず、ただちにステップ8に進むこと。**

## ステップ8: フォーマット検証

1. 作成した講義スライドが以下の要件を満たしているか確認する:
  - [ ] フロントマターが適切に設定されている
  - [ ] 各スライドが`---`で区切られている
  - [ ] タイトルと内容の間に`***`と`<div class="mt-5"></div>`が挿入されている
  - [ ] 本文の文字サイズは28pt以上
  - [ ] 画像ファイルは`public/`に保存されている
  - [ ] アイコンは適切に選択されている
  - [ ] 自己紹介が必要な場合、`pages/who_am_i.md`がインポートされている
  - [ ] 授業計画の内容がすべて網羅されている
  - [ ] スライド枚数が適切（多すぎず、少なすぎず）

2. 問題があれば修正し、再度確認する。

**このステップが正常に完了したら、決して停止せず、ただちにステップ9に進むこと。**

## ステップ9: 振り返りとドキュメント更新

1. `tasklist.md`に申し送り事項を記載する:
  ```markdown
  ## 完了報告

  - 実装完了日時: [日時]
  - 作成したスライド枚数: XX枚
  - 推定講義時間: XX分

  ### セクション別スライド枚数
  - 導入: X枚
  - 本論セクション1: X枚
  - 本論セクション2: X枚
  - ...
  - まとめ: X枚

  ### 使用したレイアウトパターン
  - 2カラムレイアウト: X箇所
  - 画像中心レイアウト: X箇所
  - リストレイアウト: X箇所

  ### 追加した画像・アイコン
  - 画像: [リスト]
  - アイコン: [リスト]

  ### 計画と実績の差分
  - 推定スライド枚数: XX枚 → 実績: XX枚
  - 理由: [差分がある場合の理由]

  ### 未作成リソース（要対応）
  - 画像: [リスト]
  - 図表: [リスト]

  ### 学んだこと・改善点
  - [記述]

  ### 次回への申し送り
  - [記述]
  ```

2. 授業計画との整合性を最終確認し、`lesson_plan/`内のドキュメントにコメントを追記する必要があるか判断する。

3. `issue.md`に記載されている改善点のうち、今回対応したものがあれば記録する。

4. git commitを実行して、完成した講義スライドを保存する:
  ```bash
  git add .
  git commit -m "Complete lecture creation: [講義名] - XX slides

  Created [講義名] with XX slides based on lesson plan.

  Sections:
  - Introduction: X slides
  - Main content: X slides
  - Summary: X slides

  Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>"
  ```

## 完了条件

このワークフローは、以下の全ての条件を満たした時点で自動的に完了となる。

- ステップ5: バックアップが作成されている。
- ステップ6: `tasklist.md`の全てのタスクが完了状態（`[x]`または正当な理由でスキップ）になっている。
- ステップ7: プレビューで全スライドの表示が確認されている。
- ステップ8: フォーマット検証をパスしている。
- ステップ9: `tasklist.md`に申し送り事項が記載され、git commitが完了している。

この完了条件を満たすまで、自律的に思考し、問題解決を行い、作業を継続すること。

## 補足: フロントマターの例

```yaml
---
theme: seriph
background: https://source.unsplash.com/collection/94734566/1920x1080
class: text-center
highlighter: shiki
lineNumbers: false
info: |
  ## 放射線治療学入門
  第1回講義資料

  医学部4年生向け
drawings:
  persist: false
transition: slide-left
title: 放射線治療学入門
mdc: true
---
```

## 補足: ページインポートの例

自己紹介が必要な場合:

```markdown
---
src: ./pages/who_am_i.md
---
```

その他のページをインポートする場合も同様の形式で記述する。
