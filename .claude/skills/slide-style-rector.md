---
name: slide-style-rector
description: スタイルガイドとレイアウトパターンに基づいてスライドを自動整形する
tools: [Read, Write, Edit, Bash, Glob]
---

# スライドスタイル自動整形

**引数:** スライドファイルパス、オプションで範囲指定

**例:**
- `slides.md` - 全スライドを整形
- `slides.md 10-20` - スライド10-20を整形
- `pages/flowchart.md` - 特定ファイルを整形

このスキルは、`docs/style-guide.md`と`format/layout-patterns.md`に基づいてスライドを自動整形します。

## 実行フロー

### ステップ1: 準備とコンテキスト設定

1. タスクコンテキストを確立:
  - 対象ファイル: 引数で指定されたスライドファイル
  - 範囲: 指定があれば範囲、なければ全体
  - 日付: YYYYMMDD形式
  - プランニングディレクトリ: `.style-planning/[日付]-[ファイル名]/`

2. プランニングファイルを作成:
  - `current-analysis.md` (現在の状態分析)
  - `style-changes.md` (スタイル変更内容)
  - `tasklist.md` (タスクリスト)

### ステップ2: プロジェクト理解

1. 参照ドキュメントを読み込む:
  - `CLAUDE.md` - プロジェクト全体のルール
  - `docs/style-guide.md` - デザイン原則とスタイルガイド
  - `format/layout-patterns.md` - レイアウトパターン集

2. 対象ファイルを読み込み、現状を分析:
  - 各スライドの構造
  - 現在のレイアウト設定
  - タイトルと本文の間隔
  - 文体（コロン、感嘆符、絵文字の使用）
  - 余白の使用状況

### ステップ3: git commitで現在の状態を保存

```bash
git add [対象ファイル]
git commit -m "Before style rector: [ファイル名]

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>"
```

### ステップ4: スライド分析とパターンマッチング

各スライドについて分析:

1. **スライドタイプの判定**:
  - タイトルページ → heroパターン
  - セクション区切り → section-titleパターン
  - テキスト+画像 → image-rightまたはimage-leftパターン
  - 比較・対比 → two-colsパターン
  - 箇条書き中心 → list-focus-patternパターン
  - 図解中心 → diagram-focusパターン
  - 引用・強調 → quote-emphasisパターン

2. **コンテンツ量の確認**:
  - リスト項目数
  - テキスト量（300文字以内が推奨）
  - 画像の有無とサイズ

3. **最適なレイアウトパターンの選択**:
  - `format/layout-patterns.md`から選択
  - コンテンツに最も適したパターンを決定

### ステップ5: スタイル適用計画の作成

style-changes.mdに変更内容を記録:

```markdown
# スライド[番号] - [タイトル]

## 現在の状態
- レイアウト: [現在]
- 問題点: [問題のリスト]

## 適用するパターン
- パターン名: [選択したパターン]
- レイアウト: [新しいレイアウト]

## 変更内容
- タイトル間隔: `***` + `<div class="mt-5"></div>` 追加
- 文体: コロン削除、感嘆符削除
- 余白: mt-5, mb-5 追加
- レイアウト: [新しいレイアウト]に変更
```

### ステップ6: 実装ループ

tasklist.mdの全タスクが完了するまで実行:

1. タスクリストを読み込む
2. 未完了タスクを確認
3. 先頭の未完了タスクを実行:

**スタイルガイドに従った整形:**

a. **デザイン原則**:
  - 1スライド1メッセージ: 複数トピックは分割
  - 視覚的階層: タイトル→サブタイトル→本文
  - 余白の活用: mt-5, mb-5で適切な間隔
  - 色の使用: プライマリカラー（#1e3a8a）をアクセントに
  - フォントサイズ: 本文28pt以上（`text-xl`または`text-2xl`クラス）

b. **文体ルール**:
  - コロン（：）を削除
  - 感嘆符（！）を削除
  - 疑問符（？）を削除（必要最小限）
  - 装飾的な絵文字を削除

c. **レイアウト適用**:
  - フロントマターに`layout:`を追加
  - 必要に応じて`image:`や`::`区切りを追加
  - タイトルと本文の間に`***`と`<div class="mt-5"></div>`を追加

d. **余白とスペーシング**:
  - セクション間: `<div class="mt-10"></div>`
  - 項目間: `<div class="mt-5"></div>`
  - リスト前後: `<div class="mt-5"></div>`

4. タスクを`[x]`に更新

**例外処理:**
- レイアウトパターンが見つからない → defaultを使用
- カスタムスタイルがある → 可能な限り維持
- 画像パスが無効 → 警告を記録して継続

### ステップ7: 実装例

**Before:**
```markdown
---
---

# リニアックの構造

リニアックは以下の構造を持っています：
- 電子銃
- 加速管
- ビーム制御システム
- 治療ヘッド

![リニアック](./images/linac.png)
```

**After:**
```markdown
---
layout: image-right
image: ./images/linac.png
---

# リニアックの構造

***

<div class="mt-5"></div>

## 主要コンポーネント

<div class="mt-5"></div>

<div class="text-xl">

- 電子銃
- 加速管
- ビーム制御システム
- 治療ヘッド

</div>
```

### ステップ8: プレビュー確認

1. 変更内容をプレビュー表示
2. ユーザーに確認を求める
3. 承認後に変更を適用

### ステップ9: フォーマット検証

チェックリスト:
- [ ] スタイルガイドに従っている
- [ ] 適切なレイアウトパターン使用
- [ ] 文体ルール適用済み（コロン、感嘆符、絵文字削除）
- [ ] タイトル間隔適切（`***` + `<div class="mt-5"></div>`）
- [ ] 本文28pt以上（`text-xl`以上）
- [ ] 余白適切（mt-5, mb-5等）
- [ ] 1スライド1メッセージ
- [ ] 既存カスタムスタイル維持

### ステップ10: 振り返りとドキュメント更新

1. tasklist.mdに申し送り事項を記載

2. git commitで保存:
```bash
git add [対象ファイル]
git commit -m "Apply style rector to [ファイル名]

Applied style guide and layout patterns:
- [変更内容のサマリー]

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>"
```

## 完了条件

- 対象スライド分析済み
- 最適なレイアウトパターン選択済み
- スタイルガイド適用済み
- 文体ルール適用済み
- tasklist.md全タスク完了
- プレビュー確認済み
- フォーマット検証済み
- 申し送り事項記載済み
- git commit完了

## スタイルガイド主要ルール

### デザイン原則
- **1スライド1メッセージ**: 複数のトピックは複数スライドに分割
- **視覚的階層**: タイトル→サブタイトル→本文の明確な階層
- **余白の活用**: mt-5, mb-5, mt-10などで読みやすさを確保
- **カラーパレット**: プライマリ #1e3a8a、アクセント #3b82f6
- **タイポグラフィ**: 本文28pt以上、タイトル36pt以上

### 文体ルール
- コロン（：）使用禁止 → 改行や箇条書きで構造化
- 感嘆符（！）使用禁止 → 冷静で客観的なトーン
- 疑問符（？）最小限 → 必要な場合のみ
- 装飾的絵文字禁止 → アイコンは適切なものを選択
- 過度な色使い禁止 → プライマリカラーをアクセントに

## 参照ドキュメント
- `docs/style-guide.md`: スタイルガイド
- `format/layout-patterns.md`: レイアウトパターン集（40種類）
- `CLAUDE.md`: プロジェクト全体のルール
